<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuclear Power Debate Preparation Tool - Final Edition</title>
</head>
<body>
    <nuclear-debate-prep></nuclear-debate-prep>

    <script>
    (function() {
        if (customElements.get('nuclear-debate-prep')) return;

        // --- SVG ICONS ---
        const icons = {
            Scale: `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></svg>`,
            Printer: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>`,
            BookOpen: `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>`,
            ChevronUp: `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m18 15-6-6-6 6"/></svg>`,
            ChevronDown: `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>`,
            ExternalLink: `<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>`,
            Lightbulb: `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>`,
            Trash2: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>`,
            Plus: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>`,
            FileText: `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>`,
            Award: `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>`,
            AlertTriangle: `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>`,
            Clock: `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>`,
            Download: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>`,
            Upload: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>`,
            Save: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>`
        };

        // --- ENHANCED WCAG-COMPLIANT STYLES (SOFTENED AESTHETIC) ---
        const css = `
            :host { 
                display: block; 
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
                line-height: 1.6;
            }
            * { box-sizing: border-box; margin: 0; padding: 0; }
            
            /* Skip Link */
            .skip-link {
                position: absolute;
                top: -40px;
                left: 0;
                background: #e8a838;
                color: #000;
                padding: 8px 16px;
                text-decoration: none;
                z-index: 100;
                font-weight: 700;
                border-radius: 0 0 4px 0;
            }
            .skip-link:focus {
                top: 0;
            }
            
            /* Layout - More scholarly aesthetic */
            .container { 
                min-height: 100vh; 
                background: linear-gradient(135deg, #1e3a5f 0%, #2d5a7b 50%, #1e3a5f 100%); 
                padding: 2rem; 
            }
            .max-w-6xl { max-width: 1200px; margin: 0 auto; }
            
            /* Header Panel */
            .header-panel { 
                background: linear-gradient(to right, #1e3a8a, #1e40af);
                border: 4px solid #3b82f6; 
                border-radius: 1rem; 
                padding: 2.5rem; 
                margin-bottom: 2rem;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            }
            
            .logo-container {
                display: flex;
                align-items: center;
                gap: 1.5rem;
                margin-bottom: 1.5rem;
            }
            
            .logo-circle {
                width: 80px;
                height: 80px;
                border-radius: 50%;
                background: linear-gradient(135deg, #e8a838, #d4941a);
                display: flex;
                align-items: center;
                justify-content: center;
                position: relative;
                flex-shrink: 0;
                box-shadow: 0 0 30px rgba(232, 168, 56, 0.5);
            }
            
            .pulse-ring {
                position: absolute;
                top: -4px;
                right: -4px;
                width: 20px;
                height: 20px;
                background: #22c55e;
                border-radius: 50%;
                animation: pulse 2s ease-in-out infinite;
            }
            
            @keyframes pulse {
                0%, 100% { transform: scale(1); opacity: 1; }
                50% { transform: scale(1.3); opacity: 0.6; }
            }
            
            h1 {
                font-size: 2.5rem;
                font-weight: 800;
                color: #e8a838;
                text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
                letter-spacing: 0.05em;
                margin: 0;
            }
            
            .subtitle {
                font-size: 1.1rem;
                color: #86efac;
                font-weight: 600;
                font-family: 'Courier New', monospace;
                margin-top: 0.5rem;
            }
            
            .intro-text {
                font-size: 1.15rem;
                color: #ffffff;
                line-height: 1.7;
                border-left: 4px solid #e8a838;
                padding-left: 1.5rem;
                margin: 1.5rem 0;
            }
            
            .button-group {
                display: flex;
                flex-wrap: wrap;
                gap: 1rem;
                margin-top: 1rem;
            }
            
            /* Controls Panel */
            .controls-panel {
                background: #1e293b;
                border: 3px solid #475569;
                border-radius: 0.75rem;
                padding: 2rem;
                margin-bottom: 2rem;
            }
            
            .grid-2 {
                display: grid;
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            @media (min-width: 768px) {
                .grid-2 { grid-template-columns: repeat(2, 1fr); }
            }
            
            /* Form Elements */
            label {
                display: block;
                font-size: 1rem;
                font-weight: 700;
                color: #e8a838;
                letter-spacing: 0.05em;
                margin-bottom: 0.75rem;
                text-transform: uppercase;
            }
            
            label.inline {
                text-transform: none;
                font-size: 0.9rem;
                color: #93c5fd;
                margin-bottom: 0.5rem;
            }
            
            input, select, textarea {
                width: 100%;
                padding: 1rem 1.25rem;
                font-size: 1.1rem;
                font-family: 'Consolas', 'Courier New', monospace;
                background: #0f172a;
                color: #86efac;
                border: 2px solid #475569;
                border-radius: 0.5rem;
                transition: all 0.2s ease;
            }
            
            input:focus, select:focus, textarea:focus {
                outline: none;
                border-color: #e8a838;
                box-shadow: 0 0 0 3px rgba(232, 168, 56, 0.3);
                background: #1e293b;
            }
            
            input::placeholder, textarea::placeholder {
                color: #94a3b8;
                opacity: 1;
            }
            
            textarea {
                min-height: 140px;
                resize: vertical;
                line-height: 1.6;
            }
            
            textarea.compact {
                min-height: 80px;
            }
            
            input[type="number"] {
                font-size: 1rem;
                padding: 0.75rem;
            }
            
            /* Buttons */
            button {
                font-family: inherit;
                cursor: pointer;
                border: none;
                background: none;
                font-size: 1rem;
                transition: all 0.2s ease;
            }
            
            .btn-primary {
                display: inline-flex;
                align-items: center;
                gap: 0.75rem;
                padding: 0.875rem 1.75rem;
                font-size: 1.1rem;
                font-weight: 700;
                color: #ffffff;
                background: linear-gradient(135deg, #16a34a, #22c55e);
                border: 2px solid #4ade80;
                border-radius: 0.5rem;
                box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
            }
            
            .btn-primary:hover {
                background: linear-gradient(135deg, #15803d, #16a34a);
                transform: translateY(-2px);
                box-shadow: 0 6px 16px rgba(34, 197, 94, 0.4);
            }
            
            .btn-primary:focus {
                outline: 3px solid #e8a838;
                outline-offset: 2px;
            }
            
            .btn-secondary {
                display: inline-flex;
                align-items: center;
                gap: 0.75rem;
                padding: 0.875rem 1.75rem;
                font-size: 1.1rem;
                font-weight: 700;
                color: #ffffff;
                background: linear-gradient(135deg, #7c3aed, #a855f7);
                border: 2px solid #c084fc;
                border-radius: 0.5rem;
                box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
            }
            
            .btn-secondary:hover {
                background: linear-gradient(135deg, #6d28d9, #7c3aed);
                transform: translateY(-2px);
            }
            
            .btn-secondary:focus {
                outline: 3px solid #e8a838;
                outline-offset: 2px;
            }
            
            .btn-tertiary {
                display: inline-flex;
                align-items: center;
                gap: 0.75rem;
                padding: 0.875rem 1.75rem;
                font-size: 1.1rem;
                font-weight: 700;
                color: #ffffff;
                background: linear-gradient(135deg, #0891b2, #06b6d4);
                border: 2px solid #22d3ee;
                border-radius: 0.5rem;
                box-shadow: 0 4px 12px rgba(34, 211, 238, 0.3);
            }
            
            .btn-tertiary:hover {
                background: linear-gradient(135deg, #0e7490, #0891b2);
                transform: translateY(-2px);
            }
            
            .btn-tertiary:focus {
                outline: 3px solid #e8a838;
                outline-offset: 2px;
            }
            
            .btn-add {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.75rem 1.5rem;
                font-weight: 700;
                color: #ffffff;
                background: #3b82f6;
                border: 2px solid #60a5fa;
                border-radius: 0.5rem;
                margin-top: 1rem;
            }
            
            .btn-add:hover {
                background: #2563eb;
                transform: translateY(-1px);
            }
            
            .btn-add:focus {
                outline: 3px solid #e8a838;
                outline-offset: 2px;
            }
            
            .btn-delete {
                color: #f87171;
                padding: 0.5rem;
                font-weight: 600;
            }
            
            .btn-delete:hover {
                color: #fca5a5;
            }
            
            .btn-delete:focus {
                outline: 2px solid #f87171;
                outline-offset: 2px;
                border-radius: 4px;
            }
            
            /* Section Panels */
            .section-panel {
                background: #1e293b;
                border: 3px solid #475569;
                border-radius: 0.75rem;
                margin-bottom: 2rem;
                overflow: hidden;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            }
            
            .section-header {
                width: 100%;
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 1.75rem 2rem;
                background: linear-gradient(to right, #1e293b, #334155);
                border-bottom: 2px solid #475569;
                text-align: left;
            }
            
            .section-header:hover {
                background: linear-gradient(to right, #334155, #475569);
            }
            
            .section-header:focus {
                outline: 3px solid #e8a838;
                outline-offset: -3px;
            }
            
            .section-title {
                display: flex;
                align-items: center;
                gap: 1rem;
            }
            
            .section-title h2 {
                font-size: 1.5rem;
                font-weight: 700;
                color: #e8a838;
                letter-spacing: 0.05em;
                margin: 0;
            }
            
            .section-content {
                padding: 2rem;
            }
            
            /* Info Boxes */
            .info-box {
                padding: 1.25rem 1.5rem;
                border-left: 4px solid;
                border-radius: 0.5rem;
                margin-bottom: 1.5rem;
                font-size: 1.05rem;
                line-height: 1.6;
            }
            
            .info-box-blue {
                background: #dbeafe;
                border-color: #3b82f6;
                color: #1e3a8a;
            }
            
            .info-box-purple {
                background: #f3e8ff;
                border-color: #a855f7;
                color: #6b21a8;
            }
            
            .info-box-green {
                background: #dcfce7;
                border-color: #22c55e;
                color: #14532d;
            }
            
            .info-box-yellow {
                background: #fef3c7;
                border-color: #f59e0b;
                color: #78350f;
            }
            
            .info-box strong {
                font-weight: 700;
            }
            
            /* Cards */
            .card {
                background: #0f172a;
                border: 2px solid #475569;
                border-left: 4px solid;
                border-radius: 0.5rem;
                padding: 1.5rem;
                margin-bottom: 1.5rem;
            }
            
            .card-blue { border-left-color: #60a5fa; }
            .card-green { border-left-color: #4ade80; }
            .card-purple { border-left-color: #c084fc; }
            .card-orange { border-left-color: #fb923c; }
            .card-teal { border-left-color: #2dd4bf; }
            .card-red { border-left-color: #f87171; }
            
            .card-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1rem;
            }
            
            .card-title {
                font-size: 1.1rem;
                font-weight: 700;
                color: #ffffff;
            }
            
            .card-blue .card-title { color: #93c5fd; }
            .card-green .card-title { color: #86efac; }
            .card-purple .card-title { color: #d8b4fe; }
            .card-orange .card-title { color: #fdba74; }
            .card-teal .card-title { color: #5eead4; }
            .card-red .card-title { color: #fca5a5; }
            
            /* CRAAP Grid */
            .craap-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 0.75rem;
                margin-top: 1rem;
                margin-bottom: 1rem;
            }
            
            .craap-item {
                display: flex;
                flex-direction: column;
                gap: 0.25rem;
            }
            
            .craap-item label {
                font-size: 0.8rem;
                margin-bottom: 0.25rem;
            }
            
            .help-text {
                font-size: 0.85rem;
                font-style: italic;
                color: #94a3b8;
                margin-top: 0.5rem;
                line-height: 1.5;
            }
            
            /* Citation Examples - Expandable */
            details {
                margin-bottom: 1.5rem;
                background: #f8fafc;
                padding: 1rem;
                border-left: 4px solid #a855f7;
                border-radius: 0.5rem;
            }
            
            summary {
                cursor: pointer;
                font-weight: 700;
                color: #6b21a8;
                margin-bottom: 0.5rem;
                list-style: none;
            }
            
            summary::-webkit-details-marker {
                display: none;
            }
            
            summary::before {
                content: 'ðŸ“š ';
                margin-right: 0.5rem;
            }
            
            details[open] summary::before {
                content: 'ðŸ“– ';
            }
            
            details div {
                color: #1e293b;
                font-size: 1rem;
                line-height: 1.6;
                margin-top: 0.75rem;
            }
            
            details ul {
                margin-left: 1.5rem;
                margin-top: 0.5rem;
            }
            
            details li {
                margin-bottom: 0.5rem;
            }
            
            /* Resource Lists */
            .resource-grid {
                display: grid;
                grid-template-columns: 1fr;
                gap: 1.5rem;
                margin-top: 1.5rem;
            }
            
            @media (min-width: 768px) {
                .resource-grid { grid-template-columns: repeat(2, 1fr); }
            }
            
            .resource-card {
                background: #f8fafc;
                border: 2px solid #cbd5e1;
                border-radius: 0.5rem;
                padding: 1.5rem;
            }
            
            .resource-card h4 {
                font-size: 1.1rem;
                font-weight: 700;
                color: #1e40af;
                margin-bottom: 0.75rem;
            }
            
            .resource-authority {
                display: inline-block;
                font-size: 0.8rem;
                font-weight: 600;
                color: #ffffff;
                background: #7c3aed;
                padding: 0.25rem 0.75rem;
                border-radius: 9999px;
                margin-bottom: 0.75rem;
            }
            
            .resource-note {
                font-size: 0.9rem;
                color: #475569;
                font-style: italic;
                margin-bottom: 1rem;
                line-height: 1.5;
            }
            
            .resource-list {
                list-style: none;
            }
            
            .resource-item {
                display: flex;
                align-items: flex-start;
                gap: 0.5rem;
                margin-bottom: 0.75rem;
                color: #1e293b;
            }
            
            .resource-bullet {
                color: #3b82f6;
                font-weight: 700;
                flex-shrink: 0;
            }
            
            .resource-link {
                color: #1e40af;
                text-decoration: underline;
                font-weight: 600;
                display: inline-flex;
                align-items: center;
                gap: 0.25rem;
            }
            
            .resource-link:hover {
                color: #2563eb;
            }
            
            .resource-link:focus {
                outline: 2px solid #1e40af;
                outline-offset: 2px;
                border-radius: 2px;
            }
            
            /* Timer */
            .timer-container {
                background: #0f172a;
                border: 3px solid #475569;
                border-radius: 0.75rem;
                padding: 2rem;
                margin-bottom: 2rem;
            }
            
            .timer-buttons {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 0.75rem;
                margin-bottom: 2rem;
            }
            
            .timer-btn {
                padding: 0.875rem;
                background: #334155;
                color: #e2e8f0;
                border: 2px solid #475569;
                border-radius: 0.5rem;
                font-weight: 600;
                text-align: center;
            }
            
            .timer-btn:hover {
                background: #475569;
                border-color: #64748b;
            }
            
            .timer-btn:focus {
                outline: 3px solid #e8a838;
                outline-offset: 2px;
            }
            
            .timer-display {
                text-align: center;
                padding: 2rem;
                background: #1e293b;
                border: 2px solid #475569;
                border-radius: 0.5rem;
                margin-bottom: 1.5rem;
            }
            
            .timer-value {
                font-size: 5rem;
                font-weight: 800;
                font-family: 'Courier New', monospace;
                color: #4ade80;
                line-height: 1;
                margin-bottom: 1rem;
            }
            
            .timer-value.warning {
                color: #f87171;
                animation: pulse 1s ease-in-out infinite;
            }
            
            .timer-label {
                font-size: 1rem;
                color: #94a3b8;
                text-transform: uppercase;
                letter-spacing: 0.1em;
            }
            
            .timer-controls {
                display: flex;
                gap: 1rem;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .timer-control-btn {
                padding: 1rem 2rem;
                font-size: 1.1rem;
                font-weight: 700;
                color: white;
                border: 3px solid;
                border-radius: 0.5rem;
                text-transform: uppercase;
                letter-spacing: 0.05em;
            }
            
            .btn-start {
                background: #16a34a;
                border-color: #22c55e;
            }
            
            .btn-start:hover {
                background: #15803d;
            }
            
            .btn-start:focus {
                outline: 3px solid #e8a838;
                outline-offset: 2px;
            }
            
            .btn-pause {
                background: #dc2626;
                border-color: #f87171;
            }
            
            .btn-pause:hover {
                background: #b91c1c;
            }
            
            .btn-pause:focus {
                outline: 3px solid #e8a838;
                outline-offset: 2px;
            }
            
            .btn-reset {
                background: #ca8a04;
                border-color: #facc15;
            }
            
            .btn-reset:hover {
                background: #a16207;
            }
            
            .btn-reset:focus {
                outline: 3px solid #e8a838;
                outline-offset: 2px;
            }
            
            /* Flow Table */
            .flow-table {
                width: 100%;
                overflow-x: auto;
                margin-top: 1.5rem;
            }
            
            table {
                width: 100%;
                border-collapse: collapse;
                background: #0f172a;
                color: #fff;
                min-width: 800px;
            }
            
            thead tr {
                background: #1e293b;
                border-bottom: 2px solid #475569;
            }
            
            th {
                padding: 1rem;
                text-align: left;
                font-weight: 700;
                font-size: 0.95rem;
            }
            
            tbody tr {
                border-bottom: 1px solid #334155;
            }
            
            td {
                padding: 1rem;
                vertical-align: top;
            }
            
            td textarea {
                min-height: 80px;
                width: 100%;
                font-size: 0.9rem;
            }
            
            /* Utility Text Colors */
            .text-white { color: #ffffff; }
            .text-yellow { color: #e8a838; }
            .text-green { color: #86efac; }
            .text-blue { color: #93c5fd; }
            .text-purple { color: #d8b4fe; }
            .text-orange { color: #fdba74; }
            .text-teal { color: #5eead4; }
            .text-red { color: #fca5a5; }
            .text-gray-light { color: #e2e8f0; }
            .text-gray { color: #cbd5e1; }
            
            /* Utility Spacing */
            .mb-1 { margin-bottom: 0.5rem; }
            .mb-2 { margin-bottom: 1rem; }
            .mb-3 { margin-bottom: 1.5rem; }
            .mb-4 { margin-bottom: 2rem; }
            .mt-1 { margin-top: 0.5rem; }
            .mt-2 { margin-top: 1rem; }
            .mt-3 { margin-top: 1.5rem; }
            .mt-4 { margin-top: 2rem; }
            
            /* Auto-save indicator */
            .save-indicator {
                position: fixed;
                top: 1rem;
                right: 1rem;
                padding: 0.75rem 1.25rem;
                background: #16a34a;
                color: white;
                border-radius: 0.5rem;
                font-weight: 600;
                font-size: 0.9rem;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                opacity: 0;
                transition: opacity 0.3s ease;
                pointer-events: none;
                z-index: 1000;
            }
            
            .save-indicator.show {
                opacity: 1;
            }
            
            /* Print Styles */
            @media print {
                .container { background: white; padding: 1rem; }
                .header-panel, .controls-panel, .section-panel { 
                    border: 2px solid #000; 
                    background: white; 
                    page-break-inside: avoid;
                }
                h1, h2, h3, label, .card-title { color: #000 !important; }
                .text-white, .text-yellow, .text-green, .text-blue { color: #000 !important; }
                input, textarea, select { 
                    border: 1px solid #000; 
                    background: white; 
                    color: #000; 
                }
                .btn-primary, .btn-secondary, .btn-tertiary, .timer-controls, .button-group, .btn-add, .btn-delete { display: none; }
                .logo-circle { border: 2px solid #000; background: #f0f0f0; }
                .pulse-ring { display: none; }
                .info-box { border: 2px solid #000; }
                .save-indicator { display: none; }
            }
        `;

        class NuclearDebatePrep extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
                
                // Initialize state
                this.state = {
                    position: 'pro',
                    selectedPlant: '',
                    expandedSections: {
                        research: true,
                        searchStrategy: false,
                        arguments: true,
                        evidence: true,
                        rubric: false,
                        factCheck: false,
                        fallacies: false,
                        debateFlow: false,
                        prep: false
                    },
                    researchNotes: {
                        intro: '', 
                        plant: '', 
                        operations: '', 
                        environmental: '', 
                        economic: '', 
                        future: ''
                    },
                    arguments: [],
                    counterArgs: [],
                    evidence: [],
                    questions: [],
                    flow: [],
                    openingStatement: '',
                    closingStatement: '',
                    timerActive: false,
                    timerSeconds: 120,
                    timerMode: 'opening'
                };

                this.timerInterval = null;
                this.storageKey = 'nuclear-debate-prep-data-final';
                this.saveTimeout = null;
                
                // Enhanced plant data
                this.plants = {
                    nj: [{
                        name: 'Salem + Hope Creek',
                        operator: 'PSEG Nuclear',
                        state: 'New Jersey',
                        reactors: 'Salem 1 & 2 (Pressurized Water Reactor - PWR), Hope Creek (Boiling Water Reactor - BWR)',
                        capacity: '3,478 MW combined',
                        commission: 'Salem 1: 1977, Salem 2: 1981, Hope Creek: 1986',
                        cooling: 'Once-through cooling using Delaware River water',
                        keyFacts: 'Largest nuclear facility on East Coast; supplies approximately 40% of New Jersey\'s electricity'
                    }],
                    ny: [
                        {
                            name: 'James A. FitzPatrick',
                            operator: 'Constellation Energy',
                            state: 'New York',
                            reactors: 'Single-unit Boiling Water Reactor (BWR)',
                            capacity: '852 MW',
                            commission: '1975',
                            cooling: 'Once-through cooling using Lake Ontario water',
                            keyFacts: 'Nearly shut down in 2017 but was purchased by Exelon (now Constellation) and remains operational'
                        },
                        {
                            name: 'Ginna',
                            operator: 'Constellation Energy',
                            state: 'New York',
                            reactors: 'Single-unit Pressurized Water Reactor (PWR)',
                            capacity: '582 MW',
                            commission: '1970',
                            cooling: 'Once-through cooling using Lake Ontario water',
                            keyFacts: 'Oldest operating nuclear plant in New York; provides power to Rochester area'
                        },
                        {
                            name: 'Nine Mile Point Unit 1',
                            operator: 'Constellation Energy',
                            state: 'New York',
                            reactors: 'Boiling Water Reactor (BWR)',
                            capacity: '621 MW',
                            commission: '1969',
                            cooling: 'Once-through cooling using Lake Ontario water',
                            keyFacts: 'Part of Nine Mile Point station which includes two units'
                        },
                        {
                            name: 'Nine Mile Point Unit 2',
                            operator: 'Constellation Energy',
                            state: 'New York',
                            reactors: 'Boiling Water Reactor (BWR)',
                            capacity: '1,287 MW',
                            commission: '1988',
                            cooling: 'Once-through cooling using Lake Ontario water',
                            keyFacts: 'Larger, newer unit at Nine Mile Point; shares site with Unit 1'
                        }
                    ]
                };
                
                // Enhanced research resources with additional perspectives
                this.researchResources = [
                    { 
                        category: 'Nuclear Power Plant Information', 
                        authorityLevel: 'Primary/Government',
                        evaluationNote: 'NRC provides regulatory oversight dataâ€”authoritative for safety records and technical specifications, but may not address economic or policy debates comprehensively.',
                        items: [
                            { name: 'U.S. Nuclear Regulatory Commission', url: 'https://www.nrc.gov' },
                            { name: 'NRC Plant Information Database', url: 'https://www.nrc.gov/reactors/operating/list-power-reactor-units.html' },
                            { name: 'Department of Energy - Nuclear', url: 'https://www.energy.gov/ne/nuclear-energy' },
                            { name: 'NYSERDA (NY State Energy)', url: 'https://www.nyserda.ny.gov' },
                            { name: 'NJ Board of Public Utilities', url: 'https://www.nj.gov/bpu/' }
                        ]
                    },
                    { 
                        category: 'Library Databases: Controversial Issues', 
                        authorityLevel: 'Secondary/Curated',
                        evaluationNote: 'Pre-vetted sources presenting multiple viewpointsâ€”ideal for understanding the debate landscape and finding balanced perspectives. Always verify and cite original sources when possible.',
                        items: [
                            { name: 'Gale in Context: Global Issues', url: 'https://link.gale.com/apps/GIC?u=nort87507' },
                            { name: 'Gale in Context: Opposing Viewpoints', url: 'https://link.gale.com/apps/OVIC?u=nort87507' },
                            { name: 'Infobase Issues & Controversies', url: 'https://online.infobaselearning.com/Direct.aspx?pid=WE57&aid=17282' },
                            { name: 'EBSCOhost Points of View', url: 'https://research.ebsco.com/c/t3bsam?db=pwh' }
                        ]
                    },
                    { 
                        category: 'Library Databases: Scientific Information', 
                        authorityLevel: 'Secondary/Educational',
                        evaluationNote: 'Excellent for understanding nuclear physics, reactor technology, and environmental science. Look for peer-reviewed sources and current research.',
                        items: [
                            { name: 'Grolier ScienceFlix', url: 'http://scienceflix.digital.scholastic.com/' },
                            { name: 'Infobase Science Online', url: 'https://online.infobaselearning.com/Direct.aspx?pid=WE40&aid=17282' },
                            { name: 'EBSCOhost Science Reference', url: 'https://research.ebsco.com/c/t3bsam?db=sch' }
                        ]
                    },
                    { 
                        category: 'General Information & News', 
                        authorityLevel: 'Tertiary/Current Events',
                        evaluationNote: 'Useful for recent developments, community perspectives, and policy changes. Cross-reference news stories with primary sources when making factual claims.',
                        items: [
                            { name: 'Britannica School', url: 'http://school.eb.com/' },
                            { name: 'New York Times', url: 'https://www.nytimes.com' },
                            { name: 'Google Scholar', url: 'https://scholar.google.com' }
                        ]
                    },
                    { 
                        category: 'Additional Perspectives', 
                        authorityLevel: 'Mixed/Diverse',
                        evaluationNote: 'International organizations, advocacy groups, and industry sources provide diverse perspectives. Pay special attention to each organization\'s mission and funding sources when evaluating their claims.',
                        items: [
                            { name: 'International Atomic Energy Agency (IAEA)', url: 'https://www.iaea.org' },
                            { name: 'Union of Concerned Scientists - Nuclear', url: 'https://www.ucsusa.org/nuclear-power' },
                            { name: 'Nuclear Energy Institute (Industry)', url: 'https://www.nei.org' },
                            { name: 'World Nuclear Association', url: 'https://www.world-nuclear.org' },
                            { name: 'EPA RadTown - Nuclear Plants', url: 'https://www.epa.gov/radtown/nuclear-power-plants' }
                        ]
                    }
                ];
            }

            connectedCallback() {
                this.loadState();
                this.render();
                this.setupTimer();
            }

            disconnectedCallback() {
                if (this.timerInterval) {
                    clearInterval(this.timerInterval);
                }
                if (this.saveTimeout) {
                    clearTimeout(this.saveTimeout);
                }
            }

            // Storage methods
            loadState() {
                try {
                    const saved = localStorage.getItem(this.storageKey);
                    if (saved) {
                        const data = JSON.parse(saved);
                        this.state = { ...this.state, ...data };
                    }
                } catch (e) {
                    console.warn('Could not load saved data:', e);
                }
            }

            saveState() {
                try {
                    localStorage.setItem(this.storageKey, JSON.stringify(this.state));
                    this.showSaveIndicator();
                } catch (e) {
                    console.warn('Could not save data:', e);
                }
            }

            debouncedSave() {
                if (this.saveTimeout) {
                    clearTimeout(this.saveTimeout);
                }
                this.saveTimeout = setTimeout(() => {
                    this.saveState();
                }, 1000);
            }

            showSaveIndicator() {
                const indicator = this.shadowRoot.querySelector('.save-indicator');
                if (indicator) {
                    indicator.classList.add('show');
                    setTimeout(() => {
                        indicator.classList.remove('show');
                    }, 2000);
                }
            }

            exportData() {
                const dataStr = JSON.stringify(this.state, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                const plantName = this.state.selectedPlant.replace(/\s+/g, '_') || 'unknown';
                a.download = `debate-prep-${this.state.position}-${plantName}-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }

            importData() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'application/json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const imported = JSON.parse(event.target.result);
                            if (imported && typeof imported === 'object') {
                                this.state = { ...this.state, ...imported };
                                this.saveState();
                                this.render();
                                alert('Data imported successfully!');
                            } else {
                                alert('Invalid file format');
                            }
                        } catch (err) {
                            alert('Error importing file: ' + err.message);
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            setupTimer() {
                this.timerInterval = setInterval(() => {
                    if (this.state.timerActive && this.state.timerSeconds > 0) {
                        this.state.timerSeconds--;
                        this.updateTimerDisplay();
                        
                        if (this.state.timerSeconds === 0) {
                            this.state.timerActive = false;
                            this.updateControlButtons();
                        }
                    }
                }, 1000);
            }

            updateTimerDisplay() {
                const display = this.shadowRoot.querySelector('.timer-value');
                if (display) {
                    const mins = Math.floor(this.state.timerSeconds / 60);
                    const secs = (this.state.timerSeconds % 60).toString().padStart(2, '0');
                    display.textContent = `${mins}:${secs}`;
                    
                    if (this.state.timerSeconds <= 30 && this.state.timerActive) {
                        display.classList.add('warning');
                    } else {
                        display.classList.remove('warning');
                    }
                }
            }

            updateControlButtons() {
                const controls = this.shadowRoot.querySelector('.timer-controls');
                if (controls) {
                    const buttons = this.state.timerActive ? 
                        `<button class="timer-control-btn btn-pause" data-action="pause" aria-label="Pause timer">Pause</button>` :
                        `<button class="timer-control-btn btn-start" data-action="start" aria-label="Start timer">Start</button>`;
                    controls.innerHTML = `${buttons}<button class="timer-control-btn btn-reset" data-action="reset" aria-label="Reset timer">Reset</button>`;
                    this.attachTimerControls();
                }
            }

            getPlantInfo() {
                const allPlants = [...this.plants.nj, ...this.plants.ny];
                return allPlants.find(p => p.name === this.state.selectedPlant);
            }

            toggleSection(section) {
                this.state.expandedSections[section] = !this.state.expandedSections[section];
                this.render();
                
                requestAnimationFrame(() => {
                    const button = this.shadowRoot.querySelector(`[data-toggle="${section}"]`);
                    if (button) {
                        button.focus();
                        button.setAttribute('aria-expanded', this.state.expandedSections[section].toString());
                    }
                });
            }

            // Render methods
            renderHeader() {
                return `
                    <div class="header-panel">
                        <div class="logo-container">
                            <div class="logo-circle" aria-hidden="true">
                                ${icons.Scale}
                                <div class="pulse-ring"></div>
                            </div>
                            <div>
                                <h1>NUCLEAR DEBATE PREP SYSTEM</h1>
                                <div class="subtitle">Research & Argumentation Module - Final Edition</div>
                            </div>
                        </div>
                        <p class="intro-text">
                            Build well-supported, intellectually honest arguments on nuclear power. This tool teaches 
                            rigorous research methodology, charitable engagement with opposing views, and transferable 
                            academic habits for college-level discourse.
                        </p>
                        <div class="button-group">
                            <button class="btn-primary" data-action="print" aria-label="Print your work">
                                ${icons.Printer} Print Your Work
                            </button>
                            <button class="btn-secondary" data-action="export" aria-label="Export data as JSON file">
                                ${icons.Download} Export Data
                            </button>
                            <button class="btn-tertiary" data-action="import" aria-label="Import previously saved data">
                                ${icons.Upload} Import Data
                            </button>
                        </div>
                    </div>
                `;
            }

            renderControls() {
                const plantInfo = this.getPlantInfo();
                return `
                    <div class="controls-panel">
                        <div class="grid-2 mb-3">
                            <div>
                                <label for="position-select">Your Debate Position</label>
                                <select id="position-select" data-bind="position" aria-describedby="position-help">
                                    <option value="pro" ${this.state.position === 'pro' ? 'selected' : ''}>PRO: Support Nuclear Energy</option>
                                    <option value="con" ${this.state.position === 'con' ? 'selected' : ''}>CON: Oppose Nuclear Energy</option>
                                </select>
                                <p id="position-help" class="help-text">
                                    Choose the position your team will defend in the debate
                                </p>
                            </div>
                            <div>
                                <label for="plant-select">Select a Nuclear Plant</label>
                                <select id="plant-select" data-bind="selectedPlant" aria-describedby="plant-help">
                                    <option value="">Choose a facility to research...</option>
                                    <optgroup label="New Jersey">
                                        ${this.plants.nj.map(p => `
                                            <option value="${p.name}" ${this.state.selectedPlant === p.name ? 'selected' : ''}>
                                                ${p.name} (${p.operator})
                                            </option>
                                        `).join('')}
                                    </optgroup>
                                    <optgroup label="New York">
                                        ${this.plants.ny.map(p => `
                                            <option value="${p.name}" ${this.state.selectedPlant === p.name ? 'selected' : ''}>
                                                ${p.name} (${p.operator})
                                            </option>
                                        `).join('')}
                                    </optgroup>
                                </select>
                                <p id="plant-help" class="help-text">
                                    Select a specific nuclear facility for focused research
                                </p>
                            </div>
                        </div>
                        ${this.state.selectedPlant && plantInfo ? `
                            <div class="info-box info-box-blue">
                                <strong>Research Protocol for ${this.state.selectedPlant}:</strong><br>
                                <strong>Reactor Type:</strong> ${plantInfo.reactors}<br>
                                <strong>Capacity:</strong> ${plantInfo.capacity}<br>
                                <strong>Commissioned:</strong> ${plantInfo.commission}<br>
                                <strong>Cooling System:</strong> ${plantInfo.cooling}<br>
                                <strong>Key Facts:</strong> ${plantInfo.keyFacts}<br><br>
                                Check the NRC's plant information database for technical specifications and inspection reports. 
                                Look for ${plantInfo.operator}'s public documents on safety and operations. 
                                Search local news archives for community response and environmental impact discussions.
                            </div>
                        ` : ''}
                        ${this.state.selectedPlant ? `
                            <div class="info-box info-box-purple">
                                <strong>Whose perspectives might be missing?</strong> Consider seeking out voices from: 
                                Indigenous communities near uranium mines, nuclear plant workers and labor unions, 
                                environmental justice organizations in fence-line communities, next-generation nuclear engineers, 
                                waste repository host communities, and climate scientists studying energy transitions.
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            renderResearchSection() {
                if (!this.state.expandedSections.research) return '';
                
                const plantInfo = this.getPlantInfo();
                const components = [
                    { 
                        key: 'intro', 
                        label: 'Nuclear Power Basics', 
                        prompt: 'In 2-3 sentences each: (1) Explain nuclear fission and how it releases energy. (2) How does a reactor convert this energy to electricity? (3) List 3 main PRO arguments you encounter in research. (4) List 3 main CON arguments you encounter. Note: You don\'t need to agree with all of theseâ€”just accurately represent what each side claims.' 
                    },
                    { 
                        key: 'plant', 
                        label: this.state.selectedPlant ? `Your Plant: ${this.state.selectedPlant}` : 'Your Plant: Location & History',
                        prompt: this.state.selectedPlant && plantInfo ? 
                            `Research and document: When was ${this.state.selectedPlant} built and commissioned (${plantInfo.commission})? Where exactly is it located? Who operates it (${plantInfo.operator})? What type of reactor is used (${plantInfo.reactors})? What are key historical events, upgrades, or incidents? How has the plant's role in regional energy evolved over time?` : 
                            'Select a plant above to see customized research prompts with technical details' 
                    },
                    { 
                        key: 'operations', 
                        label: 'Operations & Technology', 
                        prompt: plantInfo ? 
                            `Research and note: (1) Reactor type (${plantInfo.reactors.includes('PWR') ? 'Pressurized Water Reactor - explain how it works' : 'Boiling Water Reactor - explain how it works'}), (2) Nameplate capacity (${plantInfo.capacity}) vs. typical capacity factor (~90% for nuclear), (3) Annual electricity output, (4) Primary safety systems (containment, ECCS, etc.), (5) Emergency shutdown procedures (SCRAM system)` :
                            'Research and note: (1) Reactor type (PWR? BWR?), (2) Capacity in megawatts, (3) Typical capacity factor, (4) Annual output compared to demand, (5) Primary safety systems, (6) Emergency procedures'
                    },
                    { 
                        key: 'environmental', 
                        label: 'Environmental & Health Impacts', 
                        prompt: plantInfo ?
                            `Investigate: How does the plant impact local environment (thermal pollution from ${plantInfo.cooling})? What is the water temperature increase and documented impact on aquatic ecosystems? How is spent nuclear fuel currently stored (dry cask vs. cooling pools)? What volume of high-level waste is produced annually? Have there been safety incidents, radiation releases, or NRC violations? How do lifecycle carbon emissions (~12g COâ‚‚/kWh) compare to solar (~40g), wind (~11g), coal (~820g), and natural gas (~490g)? What is the land use footprint compared to equivalent renewable energy capacity?` :
                            'Investigate: Impact on local water sources (thermal pollution, water usage)? How is nuclear waste managed (on-site storage, transportation, long-term disposal plans)? What is the radiation dose to nearby communities compared to background radiation? Have there been safety incidents or violations? How do lifecycle emissions compare to alternatives? What is the land use comparison?'
                    },
                    { 
                        key: 'economic', 
                        label: 'Economic & Social Aspects', 
                        prompt: 'Research: What is the economic contribution in jobs (construction, operation, support services) and tax revenue? What are the total operating costs vs. revenue from electricity sales? How does the levelized cost of energy (LCOE) compare to new renewables (~$30-40/MWh for utility solar/wind) and existing fossil fuel plants? What subsidies or economic supports does the plant receive (e.g., Zero Emission Credits in NY/NJ)? How does the local community perceive the plantâ€”conduct a news search for recent community meetings or opposition? What alternatives exist in the region and at what cost? How would plant closure affect regional electricity prices and grid reliability?' 
                    },
                    { 
                        key: 'future', 
                        label: 'Future of Nuclear Energy in NY/NJ', 
                        prompt: 'Investigate: Are there plans for new nuclear projects (including Small Modular Reactorsâ€”SMRs), plant license extensions (from 60 to 80 years), or scheduled shutdowns? How do NY and NJ clean energy mandates (100% clean by 2040 in NY, 50% by 2030 in NJ) influence nuclear power\'s role? How does nuclear compare to renewable energy sources in meeting state climate goals? What is the timeline for renewable energy deployment to potentially replace nuclear capacity? What role might nuclear play in grid stability as intermittent renewables scale up? What are the economic and technical challenges of plant decommissioning (estimated $1+ billion, 10-15 years)?' 
                    }
                ];

                return `
                    <div class="section-content">
                        <div class="info-box info-box-blue">
                            <strong>Research Strategy & Intellectual Honesty:</strong> Nuclear power is a complex 
                            issue where knowledgeable experts reasonably disagree. Your goal is to build the 
                            <em>best-supported case</em> for your assigned position, not to find "the truth." 
                            Use diverse sources: government data for facts, peer-reviewed research for scientific consensus, 
                            industry perspectives for operational insights, and critical analysis from advocacy groups. 
                            Note where evidence is strong and where it's uncertain or contested. Strong arguments 
                            acknowledge complexity and qualify claims appropriately.
                        </div>

                        <h3 class="text-white mb-2" style="font-size: 1.3rem; font-weight: 700;">Recommended Resources</h3>
                        <div class="resource-grid">
                            ${this.researchResources.map(category => `
                                <div class="resource-card">
                                    <h4>${category.category}</h4>
                                    <span class="resource-authority">${category.authorityLevel}</span>
                                    <p class="resource-note">${category.evaluationNote}</p>
                                    <ul class="resource-list">
                                        ${category.items.map(item => `
                                            <li class="resource-item">
                                                <span class="resource-bullet">â€¢</span>
                                                <a href="${item.url}" target="_blank" rel="noopener noreferrer" class="resource-link">
                                                    ${item.name} ${icons.ExternalLink}
                                                </a>
                                            </li>
                                        `).join('')}
                                    </ul>
                                </div>
                            `).join('')}
                        </div>

                        ${components.map((comp, index) => `
                            <div class="mt-4">
                                <label for="research-${comp.key}">${comp.label}</label>
                                <p class="text-gray-light mb-2" style="font-style: italic; font-size: 1.05rem;">
                                    ${comp.prompt}
                                </p>
                                <textarea 
                                    id="research-${comp.key}"
                                    data-bind="researchNotes.${comp.key}" 
                                    placeholder="Type your research notes here..."
                                    aria-label="Research notes for ${comp.label}"
                                >${this.escapeHtml(this.state.researchNotes[comp.key])}</textarea>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            renderSearchStrategy() {
                if (!this.state.expandedSections.searchStrategy) return '';
                
                return `
                    <div class="section-content">
                        <div class="info-box info-box-purple">
                            <strong>Search Protocol:</strong> Effective database searching requires strategic use of keywords and Boolean operators. 
                            Combine terms strategically to find relevant, credible sources. Start broad, then narrow with additional terms.
                        </div>

                        <div class="grid-2">
                            <div class="card card-green">
                                <h4 class="card-title">Search Terms & Keywords</h4>
                                <ul class="text-white" style="list-style: none;">
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong>nuclear power</strong> OR <strong>nuclear energy</strong></li>
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong>reactor safety</strong> OR <strong>nuclear accidents</strong></li>
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong>radioactive waste</strong> OR <strong>spent fuel</strong></li>
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong>environmental impact</strong> AND <strong>nuclear</strong></li>
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong>baseload power</strong> OR <strong>capacity factor</strong></li>
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong>lifecycle emissions</strong> OR <strong>carbon footprint</strong></li>
                                </ul>
                            </div>

                            <div class="card card-purple">
                                <h4 class="card-title">Boolean Operators</h4>
                                <ul class="text-white" style="list-style: none;">
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong class="text-orange">AND</strong> narrows results: <em class="text-gray">nuclear AND safety AND "New York"</em></li>
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong class="text-orange">OR</strong> expands results: <em class="text-gray">reactor OR plant OR facility</em></li>
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong class="text-orange">"quotes"</strong> finds exact phrases: <em class="text-gray">"renewable energy"</em></li>
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> <strong class="text-orange">NOT</strong> excludes terms: <em class="text-gray">nuclear NOT weapons</em></li>
                                    <li class="mb-2"><span class="text-yellow">â–¸</span> Combine operators: <em class="text-gray">(nuclear OR atomic) AND (waste OR spent fuel) NOT weapons</em></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
            }

            renderArguments() {
                if (!this.state.expandedSections.arguments) return '';
                
                return `
                    <div class="section-content">
                        <div class="info-box info-box-green">
                            <strong>Toulmin Argumentation Model:</strong> Build strong arguments using this structure: 
                            <strong>Claim</strong> (what you're arguing), 
                            <strong>Data</strong> (evidence that supports it), 
                            <strong>Warrant</strong> (why the evidence supports the claim), 
                            <strong>Qualifier</strong> (degree of certaintyâ€”acknowledge limitations), and 
                            <strong>Rebuttal</strong> (acknowledgment of counterarguments). 
                            This framework helps create logical, intellectually honest arguments.
                        </div>

                        <h3 class="text-yellow mb-3" style="font-size: 1.3rem; font-weight: 700;">Your Team's Main Arguments</h3>
                        ${this.state.arguments.map((arg, index) => `
                            <div class="card card-blue">
                                <div class="card-header">
                                    <span class="card-title">ARGUMENT ${index + 1}</span>
                                    <button class="btn-delete" data-action="delete-arg" data-index="${index}" aria-label="Delete argument ${index + 1}">
                                        ${icons.Trash2} Delete
                                    </button>
                                </div>
                                
                                <label class="inline" for="arg-${index}-claim">Claim (What are you arguing?)</label>
                                <input 
                                    id="arg-${index}-claim"
                                    type="text" 
                                    value="${this.escapeHtml(arg.claim || '')}" 
                                    placeholder="e.g., Nuclear power is essential for achieving New Jersey's carbon-free energy goals by 2050"
                                    data-bind="arguments.${index}.claim"
                                />
                                
                                <label class="inline" for="arg-${index}-data" style="margin-top: 1rem;">Data/Evidence (What proves it?)</label>
                                <textarea 
                                    id="arg-${index}-data"
                                    placeholder="Specific facts, statistics, expert testimony... e.g., 'According to PSEG, Salem and Hope Creek plants produce 3,478 MW of zero-carbon baseload power, preventing 10 million tons of COâ‚‚ annually (NRC, 2024)'"
                                    data-bind="arguments.${index}.data"
                                    class="compact"
                                >${this.escapeHtml(arg.data || '')}</textarea>
                                
                                <label class="inline" for="arg-${index}-warrant" style="margin-top: 1rem;">Warrant (Why does the evidence support the claim?)</label>
                                <textarea 
                                    id="arg-${index}-warrant"
                                    placeholder="Explain the logical connection... e.g., 'Renewable sources like solar and wind are intermittent and cannot yet provide reliable baseload power at this scale. Nuclear fills the gap between fossil fuels and full renewable deployment.'"
                                    data-bind="arguments.${index}.warrant"
                                    class="compact"
                                >${this.escapeHtml(arg.warrant || '')}</textarea>
                                
                                <label class="inline" for="arg-${index}-qualifier" style="margin-top: 1rem;">Qualifier (How certain are you? Acknowledge limitations)</label>
                                <input 
                                    id="arg-${index}-qualifier"
                                    type="text" 
                                    value="${this.escapeHtml(arg.qualifier || '')}" 
                                    placeholder="e.g., 'Based on current grid technology...', 'In most scenarios...', 'Likely until battery storage advances...'"
                                    data-bind="arguments.${index}.qualifier"
                                />
                                
                                <label class="inline" for="arg-${index}-rebuttal" style="margin-top: 1rem;">Anticipated Rebuttal (What might opponents say?)</label>
                                <textarea 
                                    id="arg-${index}-rebuttal"
                                    placeholder="Acknowledge counterarguments to strengthen your position... e.g., 'Opponents may argue that battery storage can replace nuclear, but current technology cannot store enough energy for multi-day periods of low renewable output.'"
                                    data-bind="arguments.${index}.rebuttal"
                                    class="compact"
                                >${this.escapeHtml(arg.rebuttal || '')}</textarea>
                                
                                <label class="inline" for="arg-${index}-source" style="margin-top: 1rem;">Source Citation</label>
                                <input 
                                    id="arg-${index}-source"
                                    type="text" 
                                    value="${this.escapeHtml(arg.source || '')}" 
                                    placeholder="Full citation in MLA or Chicago format"
                                    data-bind="arguments.${index}.source"
                                />
                            </div>
                        `).join('')}
                        <button class="btn-add" data-action="add-arg" aria-label="Add new argument">
                            ${icons.Plus} Add Argument
                        </button>

                        <h3 class="text-yellow mb-3 mt-4" style="font-size: 1.3rem; font-weight: 700;">Engage with Opposing Views (Steelmanning)</h3>
                        <p class="text-gray-light mb-3" style="font-style: italic;">
                            Strong debaters understand opposing arguments deeply. State each counterargument 
                            <strong>in its strongest form</strong> (steelmanning), acknowledge what makes it 
                            compelling, then explain where you disagree and why. This intellectual honesty 
                            makes your position more credible and demonstrates sophisticated critical thinking.
                        </p>
                        ${this.state.counterArgs.map((counter, index) => `
                            <div class="card card-orange">
                                <div class="card-header">
                                    <span class="card-title">OPPOSING VIEW ${index + 1}</span>
                                    <button class="btn-delete" data-action="delete-counter" data-index="${index}" aria-label="Delete counter-argument ${index + 1}">
                                        ${icons.Trash2} Delete
                                    </button>
                                </div>
                                <label class="inline" for="counter-${index}-opposing">State the Opposing Argument in Its Strongest Form</label>
                                <input 
                                    id="counter-${index}-opposing"
                                    type="text" 
                                    value="${this.escapeHtml(counter.opposing || '')}" 
                                    placeholder="What will the other side argue? Be generous and accurate to their position."
                                    data-bind="counterArgs.${index}.opposing"
                                />
                                <label class="inline" for="counter-${index}-understanding" style="margin-top: 1rem;">Why Might Someone Reasonably Hold This View?</label>
                                <textarea 
                                    id="counter-${index}-understanding"
                                    placeholder="What evidence or reasoning makes this position compelling? What values or priorities does it reflect? Demonstrate that you understand their perspective."
                                    data-bind="counterArgs.${index}.understanding"
                                    class="compact"
                                >${this.escapeHtml(counter.understanding || '')}</textarea>
                                <label class="inline" for="counter-${index}-rebuttal" style="margin-top: 1rem;">Where You Disagree and Why</label>
                                <textarea 
                                    id="counter-${index}-rebuttal"
                                    placeholder="Now explain your counter-evidence and reasoning. Why do you think your position is better supported, despite the strength of their argument?"
                                    data-bind="counterArgs.${index}.rebuttal"
                                >${this.escapeHtml(counter.rebuttal || '')}</textarea>
                            </div>
                        `).join('')}
                        <button class="btn-add" data-action="add-counter" aria-label="Add new counter-argument">
                            ${icons.Plus} Add Opposing View
                        </button>
                    </div>
                `;
            }

            renderEvidence() {
                if (!this.state.expandedSections.evidence) return '';
                
                return `
                    <div class="section-content">
                        <div class="info-box info-box-purple">
                            <strong>Source Evaluation with CRAAP Test:</strong> Evaluate each source using these criteria: 
                            <strong>Currency</strong> (how recent?), 
                            <strong>Relevance</strong> (how applicable?), 
                            <strong>Authority</strong> (who's the author/publisher?), 
                            <strong>Accuracy</strong> (is it verifiable and correct?), 
                            <strong>Purpose</strong> (why does it exist? any bias?). 
                            Rate each 1-5; sources averaging 4+ are generally reliable for academic use.
                        </div>

                        <details>
                            <summary>Click to see citation format examples</summary>
                            <div>
                                <strong>MLA 9th Edition Examples:</strong>
                                <ul>
                                    <li>
                                        <strong>Journal Article:</strong><br>
                                        Smith, Jane. "Nuclear Safety After Fukushima." <em>Energy Policy</em>, vol. 45, 2022, pp. 12-28.
                                    </li>
                                    <li>
                                        <strong>Website:</strong><br>
                                        Nuclear Regulatory Commission. "Operating Nuclear Power Reactors." <em>NRC.gov</em>, 15 Jan. 2024, www.nrc.gov/reactors/operating.html.
                                    </li>
                                    <li>
                                        <strong>Database Article:</strong><br>
                                        Doe, John. "Climate and Nuclear Power." <em>Gale Opposing Viewpoints</em>, 2023. Accessed 1 Feb. 2024.
                                    </li>
                                </ul>
                                <strong style="margin-top: 1rem; display: block;">Chicago Style Examples:</strong>
                                <ul>
                                    <li>
                                        <strong>Journal Article:</strong><br>
                                        Smith, Jane. "Nuclear Safety After Fukushima." <em>Energy Policy</em> 45 (2022): 12-28.
                                    </li>
                                    <li>
                                        <strong>Website:</strong><br>
                                        Nuclear Regulatory Commission. "Operating Nuclear Power Reactors." NRC.gov. January 15, 2024. https://www.nrc.gov/reactors/operating.html.
                                    </li>
                                </ul>
                            </div>
                        </details>

                        ${this.state.evidence.map((item, index) => {
                            const citationType = item.citationType || 'mla';
                            return `
                            <div class="card card-purple">
                                <div class="card-header">
                                    <span class="card-title">EVIDENCE ${index + 1}</span>
                                    <select data-bind="evidence.${index}.citationType" style="font-size: 0.9rem; padding: 0.5rem;" aria-label="Citation format for evidence ${index + 1}">
                                        <option value="mla" ${citationType === 'mla' ? 'selected' : ''}>MLA Format</option>
                                        <option value="chicago" ${citationType === 'chicago' ? 'selected' : ''}>Chicago Format</option>
                                    </select>
                                    <button class="btn-delete" data-action="delete-evidence" data-index="${index}" aria-label="Delete evidence ${index + 1}">
                                        ${icons.Trash2} Delete
                                    </button>
                                </div>
                                
                                <label class="inline" for="evidence-${index}-claim">Claim, Fact, or Statistic</label>
                                <input 
                                    id="evidence-${index}-claim"
                                    type="text" 
                                    value="${this.escapeHtml(item.claim || '')}" 
                                    placeholder="e.g., Nuclear power has the lowest lifecycle carbon emissions of any reliable baseload energy source"
                                    data-bind="evidence.${index}.claim"
                                />
                                
                                <label class="inline" for="evidence-${index}-source" style="margin-top: 1rem;">Source Name & Author</label>
                                <input 
                                    id="evidence-${index}-source"
                                    type="text" 
                                    value="${this.escapeHtml(item.source || '')}" 
                                    placeholder="e.g., Intergovernmental Panel on Climate Change (IPCC), Special Report on Climate Change"
                                    data-bind="evidence.${index}.source"
                                />
                                
                                <label class="inline" for="evidence-${index}-citation" style="margin-top: 1rem;">Full Citation</label>
                                ${citationType === 'mla' ? `
                                    <p class="help-text">
                                        <strong>MLA Example:</strong> Author Last, First. "Article Title." <em>Journal Name</em>, vol. #, no. #, Year, pp. #-#. Database Name, DOI or URL.
                                    </p>
                                ` : `
                                    <p class="help-text">
                                        <strong>Chicago Example:</strong> Author Last, First. "Article Title." <em>Journal Name</em> vol #, no. # (Year): #-#. Database Name (accession number).
                                    </p>
                                `}
                                <input 
                                    id="evidence-${index}-citation"
                                    type="text" 
                                    value="${this.escapeHtml(item.citation || '')}" 
                                    placeholder="Complete ${citationType.toUpperCase()} citation..."
                                    data-bind="evidence.${index}.citation"
                                />
                                
                                <label class="inline" style="margin-top: 1.5rem;">CRAAP Test Evaluation (1-5 scale)</label>
                                <p class="help-text">Rate each criterion: 1=poor, 2=fair, 3=good, 4=very good, 5=excellent. Aim for sources averaging 4+ overall.</p>
                                <div class="craap-grid">
                                    <div class="craap-item">
                                        <label class="inline" for="evidence-${index}-currency">Currency</label>
                                        <input 
                                            id="evidence-${index}-currency"
                                            type="number" 
                                            min="1" 
                                            max="5" 
                                            value="${item.currency || ''}"
                                            data-bind="evidence.${index}.currency" 
                                            placeholder="1-5"
                                            aria-label="Currency rating for evidence ${index + 1}"
                                        />
                                    </div>
                                    <div class="craap-item">
                                        <label class="inline" for="evidence-${index}-relevance">Relevance</label>
                                        <input 
                                            id="evidence-${index}-relevance"
                                            type="number" 
                                            min="1" 
                                            max="5" 
                                            value="${item.relevance || ''}"
                                            data-bind="evidence.${index}.relevance" 
                                            placeholder="1-5"
                                            aria-label="Relevance rating for evidence ${index + 1}"
                                        />
                                    </div>
                                    <div class="craap-item">
                                        <label class="inline" for="evidence-${index}-authority">Authority</label>
                                        <input 
                                            id="evidence-${index}-authority"
                                            type="number" 
                                            min="1" 
                                            max="5" 
                                            value="${item.authority || ''}"
                                            data-bind="evidence.${index}.authority" 
                                            placeholder="1-5"
                                            aria-label="Authority rating for evidence ${index + 1}"
                                        />
                                    </div>
                                    <div class="craap-item">
                                        <label class="inline" for="evidence-${index}-accuracy">Accuracy</label>
                                        <input 
                                            id="evidence-${index}-accuracy"
                                            type="number" 
                                            min="1" 
                                            max="5" 
                                            value="${item.accuracy || ''}"
                                            data-bind="evidence.${index}.accuracy" 
                                            placeholder="1-5"
                                            aria-label="Accuracy rating for evidence ${index + 1}"
                                        />
                                    </div>
                                    <div class="craap-item">
                                        <label class="inline" for="evidence-${index}-purpose">Purpose</label>
                                        <input 
                                            id="evidence-${index}-purpose"
                                            type="number" 
                                            min="1" 
                                            max="5" 
                                            value="${item.purpose || ''}"
                                            data-bind="evidence.${index}.purpose" 
                                            placeholder="1-5"
                                            aria-label="Purpose rating for evidence ${index + 1}"
                                        />
                                    </div>
                                </div>
                                
                                <label class="inline" for="evidence-${index}-reliability" style="margin-top: 1rem;">Source Reliability Analysis</label>
                                <textarea 
                                    id="evidence-${index}-reliability"
                                    placeholder="Why is this source reliable? Consider: author credentials, peer review status, publication reputation, potential bias, date of publication, supporting evidence..."
                                    data-bind="evidence.${index}.reliability"
                                >${this.escapeHtml(item.reliability || '')}</textarea>
                            </div>
                        `}).join('')}
                        <button class="btn-add" data-action="add-evidence" aria-label="Add new evidence">
                            ${icons.Plus} Add Evidence
                        </button>
                    </div>
                `;
            }

            renderRubric() {
                if (!this.state.expandedSections.rubric) return '';
                
                const criteria = [
                    { 
                        title: 'Opening Statement (3 pts)', 
                        desc: 'Clear position statement with engaging introduction, effective preview of main arguments, and strong hook for audience attention' 
                    },
                    { 
                        title: 'Use of Evidence (4 pts)', 
                        desc: 'Variety of credible, current sources; accurate data and statistics; proper citations in consistent format (MLA or Chicago)' 
                    },
                    { 
                        title: 'Argumentation (4 pts)', 
                        desc: 'Logical flow using Toulmin model (claims, data, warrants); strong reasoning; avoids fallacies; clear connection to thesis' 
                    },
                    {
                        title: 'Intellectual Humility (4 pts)',
                        desc: 'Acknowledges complexity and uncertainty where appropriate; qualifies claims fairly; engages charitably with opposing views using steelmanning; demonstrates nuanced understanding'
                    },
                    { 
                        title: 'Cross-Examination (3 pts)', 
                        desc: 'Insightful, challenging questions that expose weaknesses; clear, evidence-based answers; maintains composure and professionalism under pressure' 
                    },
                    { 
                        title: 'Presentation Skills (4 pts)', 
                        desc: 'Consistent eye contact; clear voice projection and appropriate pacing; persuasive tone; minimal reliance on notes' 
                    },
                    { 
                        title: 'Teamwork (4 pts)', 
                        desc: 'Smooth transitions between speakers; balanced participation among all members; well-coordinated strategy and task division' 
                    },
                    { 
                        title: 'Closing Statement (4 pts)', 
                        desc: 'Strong synthesis of key arguments; addresses opponent\'s weaknesses fairly; compelling final appeal; memorable conclusion' 
                    }
                ];

                return `
                    <div class="section-content">
                        <div class="info-box info-box-yellow">
                            <strong>Assessment Criteria:</strong> Total of 30 points across eight categories. 
                            Notice that intellectual humility is a graded criterionâ€”your ability to acknowledge 
                            complexity, qualify claims appropriately, and engage charitably with opposing views 
                            demonstrates sophisticated academic thinking and is valued alongside evidence and logic.
                        </div>

                        <div class="grid-2">
                            ${criteria.map(item => `
                                <div class="card card-green">
                                    <h4 class="card-title">${item.title}</h4>
                                    <p class="text-white">${item.desc}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            renderFactCheck() {
                if (!this.state.expandedSections.factCheck) return '';
                
                const factCheckScenarios = [
                    {
                        claim: '"Nuclear power produces zero emissions"',
                        analysis: 'Nuance needed: Zero emissions during operation, but uranium mining, enrichment, and plant construction do produce COâ‚‚. Lifecycle emissions are low (~12g COâ‚‚/kWh) compared to fossil fuels (coal: ~820g, natural gas: ~490g) but not literally zero. This is still far lower than fossil fuels and comparable to wind power.',
                        questions: [
                            'What boundaries are used for "zero"â€”operational only or full lifecycle?',
                            'How do lifecycle emissions compare to solar (~40g), wind (~11g), and hydroelectric (~24g)?',
                            'Are we including decommissioning and waste storage in the calculation?'
                        ]
                    },
                    {
                        claim: '"Nuclear waste remains dangerous for thousands of years"',
                        analysis: 'Accurate but needs context: High-level waste (spent fuel) remains hazardous for ~10,000 years, with radioactivity decreasing over time. However, the volume is remarkably smallâ€”a lifetime of electricity for one person produces waste the size of a soda can. Modern dry cask storage has proven safe and secure, though permanent geological disposal (like Finland\'s Onkalo) is the long-term solution.',
                        questions: [
                            'What volume of high-level waste does this specific plant produce annually?',
                            'How does toxicity decay over time? (Most dangerous isotopes decay within 300-500 years)',
                            'What are the actual risks of current dry cask storage vs. theoretical geological repositories?',
                            'How does nuclear waste compare in volume and toxicity to coal ash or solar panel disposal?'
                        ]
                    },
                    {
                        claim: '"Nuclear is the cheapest/most expensive energy source"',
                        analysis: 'Highly misleading without context: Levelized Cost of Energy (LCOE) varies dramatically by region, regulatory environment, and whether comparing existing plants or new construction. Existing nuclear plants have low operating costs (~$30/MWh) making them competitive. New nuclear construction is expensive ($6,000-10,000/kW) due to complex safety systems, but operates for 60-80 years. Meanwhile, new renewables have lower capital costs but require backup/storage.',
                        questions: [
                            'Are we comparing existing plants or new construction costs?',
                            'Does this include decommissioning, waste management, and insurance costs?',
                            'What about subsidiesâ€”both for nuclear (Price-Anderson Act) and renewables (tax credits)?',
                            'How do we account for capacity factor differences? (Nuclear ~90% vs. solar ~25%, wind ~35%)',
                            'Are storage costs included for renewables to match nuclear\'s reliability?'
                        ]
                    },
                    {
                        claim: '"Nuclear accidents like Chernobyl/Fukushima prove nuclear is unsafe"',
                        analysis: 'Requires historical context: Chernobyl (1986) involved a flawed Soviet reactor design (RBMK) and safety culture that doesn\'t exist in U.S./Western plants. Fukushima (2011) was caused by an unprecedented tsunami, not routine operations, and resulted in zero radiation deaths (though evacuation stress caused ~2,000 deaths). Modern Western reactors have multiple redundant safety systems. However, the psychological and economic impacts of accidents are real and significant.',
                        questions: [
                            'How many people actually died from radiation at Three Mile Island (0), Chernobyl (~50 direct, ~4,000 eventual cancer deaths per UN estimate), and Fukushima (0)?',
                            'How do these compare to deaths from fossil fuel pollution (~8 million/year globally from air pollution)?',
                            'What design differences exist between Soviet RBMK, 1970s light water reactors, and modern Gen III+ reactors?',
                            'What is the statistical safety record per terawatt-hour of electricity produced?'
                        ]
                    },
                    {
                        claim: '"We can replace nuclear with 100% renewables"',
                        analysis: 'Technically possible but practically complex: Several studies show pathways to 100% renewable grids, but they require massive energy storage (batteries, pumped hydro, hydrogen), transmission infrastructure upgrades, and demand flexibility. Nuclear provides reliable baseload power that renewables + current storage cannot yet match at scale. The question isn\'t either/or, but what combination achieves climate goals fastest and most affordably.',
                        questions: [
                            'What is the current state of grid-scale energy storage technology and costs?',
                            'How much overbuild of renewable capacity is needed to ensure reliability during low-wind/low-sun periods?',
                            'What is the land use footprint comparison? (Nuclear: ~1 sq mile per 1000 MW vs. solar: ~75 sq miles)',
                            'What is the timelineâ€”can renewables scale fast enough to replace nuclear AND fossil fuels by climate deadlines?'
                        ]
                    }
                ];
                
                return `
                    <div class="section-content">
                        <div class="info-box info-box-yellow">
                            <strong>Critical Thinking:</strong> Nuclear energy debates often involve claims that are technically true but lack context, 
                            or use different assumptions to reach opposite conclusions. Always ask: 
                            <em>"Compared to what? Over what timeframe? Using whose data? What's the baseline?"</em> 
                            The most sophisticated arguments acknowledge complexity rather than presenting false certainty.
                        </div>

                        <h3 class="text-yellow mb-3" style="font-size: 1.3rem; font-weight: 700;">Common Claims Requiring Context</h3>
                        ${factCheckScenarios.map((scenario, idx) => `
                            <div class="card card-orange" style="margin-bottom: 1.5rem;">
                                <h4 class="card-title">Scenario ${idx + 1}: ${scenario.claim}</h4>
                                <p class="text-white mb-2"><strong>Analysis:</strong> ${scenario.analysis}</p>
                                <p class="text-white"><strong>Questions to Ask:</strong></p>
                                <ul class="text-white" style="list-style: none; padding-left: 1rem;">
                                    ${scenario.questions.map(q => `<li style="margin-bottom: 0.5rem;">â€¢ ${q}</li>`).join('')}
                                </ul>
                            </div>
                        `).join('')}

                        <h3 class="text-yellow mb-3 mt-4" style="font-size: 1.3rem; font-weight: 700;">General Fact-Checking Framework</h3>
                        <div class="grid-2">
                            <div class="card card-orange">
                                <h4 class="card-title">Currency & Bias</h4>
                                <ul class="text-white" style="list-style: none;">
                                    <li class="mb-2">âœ“ Is the information up to date? (Nuclear tech and policy change)</li>
                                    <li class="mb-2">âœ“ Does the source have financial or political stakes? (Industry vs. environmental groups)</li>
                                    <li class="mb-2">âœ“ Are multiple perspectives represented, or just one viewpoint?</li>
                                    <li class="mb-2">âœ“ Does the author acknowledge limitations and uncertainty?</li>
                                </ul>
                            </div>

                            <div class="card card-orange">
                                <h4 class="card-title">Context & Numbers</h4>
                                <ul class="text-white" style="list-style: none;">
                                    <li class="mb-2">âœ“ Are there caveats or limitations to the data presented?</li>
                                    <li class="mb-2">âœ“ Could this statistic be misleading without context?</li>
                                    <li class="mb-2">âœ“ What's the baseline for comparison? (Per kWh? Per year? Per capita?)</li>
                                    <li class="mb-2">âœ“ Are absolute numbers or percentages more meaningful here?</li>
                                </ul>
                            </div>

                            <div class="card card-orange">
                                <h4 class="card-title">Causation vs. Correlation</h4>
                                <ul class="text-white" style="list-style: none;">
                                    <li class="mb-2">âœ“ Is this correlation (things happening together) or causation (one causes the other)?</li>
                                    <li class="mb-2">âœ“ Are there other explanatory factors not mentioned?</li>
                                    <li class="mb-2">âœ“ What evidence directly supports the causal claim?</li>
                                    <li class="mb-2">âœ“ Could the causation run in the opposite direction?</li>
                                </ul>
                            </div>

                            <div class="card card-orange">
                                <h4 class="card-title">Source Authority</h4>
                                <ul class="text-white" style="list-style: none;">
                                    <li class="mb-2">âœ“ Who is the author? What are their credentials and expertise?</li>
                                    <li class="mb-2">âœ“ Is this peer-reviewed, fact-checked by independent sources?</li>
                                    <li class="mb-2">âœ“ Can you verify this claim in multiple credible sources?</li>
                                    <li class="mb-2">âœ“ Is the publication reputable? (Check impact factor for journals)</li>
                                </ul>
                            </div>

                            <div class="card card-orange" style="grid-column: span 2;">
                                <h4 class="card-title">Lateral Reading (Wikipedia Test)</h4>
                                <ul class="text-white" style="list-style: none;">
                                    <li class="mb-2">âœ“ Don't just read the source itselfâ€”search FOR it</li>
                                    <li class="mb-2">âœ“ Open a new tab and Google the organization's name</li>
                                    <li class="mb-2">âœ“ Check Wikipedia, SourceWatch, or Media Bias/Fact Check</li>
                                    <li class="mb-2">âœ“ What do OTHER sources say about THIS source?</li>
                                    <li class="mb-2">âœ“ Example: "Nuclear Energy Institute" â†’ Wikipedia shows it's an industry trade group (not neutral)</li>
                                    <li class="mb-2">âœ“ Example: "Union of Concerned Scientists" â†’ Wikipedia shows it's an advocacy org focused on science policy</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
            }

            renderFallacies() {
                if (!this.state.expandedSections.fallacies) return '';
                
                const fallacies = [
                    { 
                        name: 'Ad Hominem', 
                        desc: 'Attacking the person making the argument instead of addressing the argument itself',
                        example: '"You can\'t trust their data on nuclear safetyâ€”they work for the nuclear industry!" (Dismisses argument based on who said it, not whether it\'s true)'
                    },
                    { 
                        name: 'Straw Man', 
                        desc: 'Misrepresenting an opponent\'s argument to make it easier to attack',
                        example: '"Pro-nuclear advocates don\'t care about renewable energy at all!" (Mischaracterizes positionâ€”most support both nuclear AND renewables)'
                    },
                    { 
                        name: 'False Dichotomy (Either/Or)', 
                        desc: 'Presenting only two options when more alternatives exist',
                        example: '"We must choose between nuclear power or fossil fuelsâ€”there\'s no other way!" (Ignores renewables, efficiency, storage, etc.)'
                    },
                    { 
                        name: 'Cherry-Picking', 
                        desc: 'Selecting only evidence that supports your position while ignoring contradicting evidence',
                        example: 'Citing only Chernobyl and Fukushima while ignoring decades of safe operation at hundreds of other plants'
                    },
                    { 
                        name: 'Appeal to Emotion', 
                        desc: 'Using emotional manipulation instead of logical reasoning',
                        example: '"Think of the children who might be exposed to radiation!" (Uses fear without statistical risk assessment)'
                    },
                    { 
                        name: 'Hasty Generalization', 
                        desc: 'Drawing broad conclusions from limited or unrepresentative evidence',
                        example: '"One study found increased cancer rates near a plant, therefore all nuclear plants cause cancer." (Ignores larger body of research)'
                    },
                    { 
                        name: 'Slippery Slope', 
                        desc: 'Arguing that one action will inevitably lead to extreme consequences without evidence',
                        example: '"If we build nuclear plants, soon we\'ll have nuclear weapons everywhere and constant radiation leaks!" (No evidence for inevitable progression)'
                    },
                    { 
                        name: 'Appeal to Authority', 
                        desc: 'Claiming something is true solely because an authority figure says so, without examining their reasoning',
                        example: '"A famous actor opposes nuclear power, so it must be dangerous!" (Actor may lack relevant expertise)'
                    },
                    {
                        name: 'Whataboutism',
                        desc: 'Deflecting criticism by pointing to problems elsewhere instead of addressing the argument',
                        example: '"Why worry about nuclear waste when coal produces way more pollution?" (Both can be problems worth addressing)'
                    },
                    {
                        name: 'Naturalistic Fallacy',
                        desc: 'Assuming that what is "natural" is automatically better or safer',
                        example: '"Solar and wind are natural, so they\'re better than artificial nuclear reactions." (Natural â‰  automatically superior; uranium is also natural)'
                    }
                ];

                return `
                    <div class="section-content">
                        <div class="info-box info-box-yellow">
                            <strong>Logical Fallacies:</strong> Recognize these common errors in reasoning to avoid them in your own arguments 
                            and identify them when opponents use them. Pointing out a fallacy can be effective, but do so respectfullyâ€”
                            explain WHY the reasoning is flawed rather than just labeling it. Remember: finding a fallacy doesn't automatically 
                            mean the conclusion is wrong, just that this particular reasoning doesn't support it.
                        </div>

                        <div class="grid-2">
                            ${fallacies.map(fallacy => `
                                <div class="card card-red">
                                    <h4 class="card-title">${fallacy.name}</h4>
                                    <p class="text-white mb-2"><strong>Definition:</strong> ${fallacy.desc}</p>
                                    ${fallacy.example ? `<p class="text-white"><strong>Example:</strong> ${fallacy.example}</p>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            renderDebateFlow() {
                if (!this.state.expandedSections.debateFlow) return '';
                
                while (this.state.flow.length < this.state.arguments.length) {
                    this.state.flow.push({ opening: '', opponentRebuttal: '', extension: '', closing: '' });
                }
                
                return `
                    <div class="section-content">
                        <div class="info-box info-box-blue">
                            <strong>Debate Flow Tracking:</strong> Map how your arguments progress through each phase of the debate. 
                            Track which arguments are extended, dropped, or successfully refuted. 
                            This helps you maintain consistency and identify which points to emphasize in your closing.
                        </div>

                        <div class="flow-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th style="color: #e8a838;">Argument</th>
                                        <th style="color: #86efac;">Your Opening (2min)</th>
                                        <th style="color: #f87171;">Opponent Rebuttal (2min)</th>
                                        <th style="color: #86efac;">Your Extension (in main)</th>
                                        <th style="color: #93c5fd;">Closing Impact</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${this.state.arguments.map((arg, idx) => {
                                        const flow = this.state.flow[idx] || { opening: '', opponentRebuttal: '', extension: '', closing: '' };
                                        return `
                                        <tr>
                                            <td style="font-weight: 700;">#${idx + 1}</td>
                                            <td>
                                                <textarea 
                                                    data-bind="flow.${idx}.opening" 
                                                    placeholder="How will you introduce this argument?"
                                                    aria-label="Opening for argument ${idx + 1}"
                                                >${this.escapeHtml(flow.opening || '')}</textarea>
                                            </td>
                                            <td>
                                                <textarea 
                                                    data-bind="flow.${idx}.opponentRebuttal" 
                                                    placeholder="What might opponents say against it?"
                                                    aria-label="Opponent rebuttal for argument ${idx + 1}"
                                                >${this.escapeHtml(flow.opponentRebuttal || '')}</textarea>
                                            </td>
                                            <td>
                                                <textarea 
                                                    data-bind="flow.${idx}.extension" 
                                                    placeholder="How will you rebuild and extend?"
                                                    aria-label="Extension for argument ${idx + 1}"
                                                >${this.escapeHtml(flow.extension || '')}</textarea>
                                            </td>
                                            <td>
                                                <textarea 
                                                    data-bind="flow.${idx}.closing" 
                                                    placeholder="Why does this win the debate?"
                                                    aria-label="Closing impact for argument ${idx + 1}"
                                                >${this.escapeHtml(flow.closing || '')}</textarea>
                                            </td>
                                        </tr>
                                    `}).join('')}
                                </tbody>
                            </table>
                        </div>
                        
                        ${this.state.arguments.length === 0 ? `
                            <p class="text-gray-light mt-3" style="text-align: center; font-style: italic;">
                                Add arguments in the "Main Arguments & Rebuttals" section to populate this flow tracker.
                            </p>
                        ` : ''}
                    </div>
                `;
            }

            renderPrep() {
                if (!this.state.expandedSections.prep) return '';
                
                const timerModes = [
                    { mode: 'opening', label: 'Opening', seconds: 120 },
                    { mode: 'arguments', label: 'Arguments', seconds: 240 },
                    { mode: 'rebuttal', label: 'Rebuttal', seconds: 120 },
                    { mode: 'crossExam', label: 'Cross-Exam', seconds: 180 },
                    { mode: 'closing', label: 'Closing', seconds: 120 }
                ];

                return `
                    <div class="section-content">
                        <div class="timer-container">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                                ${icons.Clock}
                                <h3 class="text-green" style="font-size: 1.5rem; font-weight: 700; margin: 0;">Debate Timer</h3>
                            </div>

                            <div class="timer-buttons">
                                ${timerModes.map(tm => `
                                    <button 
                                        class="timer-btn" 
                                        data-timer="${tm.mode}" 
                                        data-seconds="${tm.seconds}"
                                        aria-label="Set timer to ${tm.label} - ${Math.floor(tm.seconds/60)} minutes ${tm.seconds%60} seconds"
                                    >
                                        ${tm.label}<br>${Math.floor(tm.seconds/60)}:${(tm.seconds%60).toString().padStart(2,'0')}
                                    </button>
                                `).join('')}
                            </div>

                            <div class="timer-display" role="timer" aria-live="polite" aria-atomic="true">
                                <div class="timer-value" aria-label="Time remaining">
                                    ${Math.floor(this.state.timerSeconds/60)}:${(this.state.timerSeconds%60).toString().padStart(2,'0')}
                                </div>
                                <div class="timer-label">${this.state.timerMode.replace(/([A-Z])/g, ' $1').toUpperCase()}</div>
                            </div>

                            <div class="timer-controls">
                                ${this.state.timerActive ? 
                                    `<button class="timer-control-btn btn-pause" data-action="pause" aria-label="Pause timer">Pause</button>` :
                                    `<button class="timer-control-btn btn-start" data-action="start" aria-label="Start timer">Start</button>`
                                }
                                <button class="timer-control-btn btn-reset" data-action="reset" aria-label="Reset timer">Reset</button>
                            </div>
                        </div>

                        <div class="mt-4">
                            <label for="opening-statement">Opening Statement (2 Minutes)</label>
                            <p class="text-gray-light mb-2" style="font-style: italic;">
                                Hook the audience with a compelling opening, clearly state your position, 
                                preview your main arguments (signpost), and establish credibility. Remember to acknowledge 
                                the complexity of the issue to build trust.
                            </p>
                            <textarea 
                                id="opening-statement"
                                data-bind="openingStatement" 
                                placeholder="Draft your opening statement here..."
                                aria-label="Opening statement draft"
                            >${this.escapeHtml(this.state.openingStatement)}</textarea>
                        </div>

                        <div class="mt-4">
                            <h3 class="text-yellow mb-3" style="font-size: 1.3rem; font-weight: 700;">Cross-Examination Questions (3 Minutes)</h3>
                            <p class="text-gray-light mb-3" style="font-style: italic;">
                                Prepare strategic questions to challenge or clarify the opposing team's positions. 
                                Good questions expose weaknesses, force them to defend specific claims, or get them to concede points. 
                                Ask genuine questions, not rhetorical ones.
                            </p>
                            ${this.state.questions.map((q, index) => `
                                <div class="card card-teal">
                                    <div class="card-header">
                                        <span class="card-title">QUESTION ${index + 1}</span>
                                        <button class="btn-delete" data-action="delete-question" data-index="${index}" aria-label="Delete question ${index + 1}">
                                            ${icons.Trash2} Delete
                                        </button>
                                    </div>
                                    <label class="inline" for="question-${index}-question">Question to Ask</label>
                                    <input 
                                        id="question-${index}-question"
                                        type="text" 
                                        value="${this.escapeHtml(q.question || '')}" 
                                        placeholder="Question for opposing team..."
                                        data-bind="questions.${index}.question"
                                    />
                                    <label class="inline" for="question-${index}-purpose" style="margin-top: 1rem;">Purpose or Follow-Up Strategy</label>
                                    <input 
                                        id="question-${index}-purpose"
                                        type="text" 
                                        value="${this.escapeHtml(q.purpose || '')}" 
                                        placeholder="Why are you asking this? What follow-up will you use?"
                                        data-bind="questions.${index}.purpose"
                                    />
                                </div>
                            `).join('')}
                            <button class="btn-add" data-action="add-question" aria-label="Add cross-examination question">
                                ${icons.Plus} Add Question
                            </button>
                        </div>

                        <div class="mt-4">
                            <label for="closing-statement">Closing Statement (2 Minutes)</label>
                            <p class="text-gray-light mb-2" style="font-style: italic;">
                                Synthesize your key arguments, highlight where you won exchanges, 
                                address your strongest opponent points fairly, and make a compelling final appeal. 
                                Acknowledge the other side's valid concerns while explaining why your position is better supported.
                            </p>
                            <textarea 
                                id="closing-statement"
                                data-bind="closingStatement" 
                                placeholder="Draft your closing statement here..."
                                aria-label="Closing statement draft"
                            >${this.escapeHtml(this.state.closingStatement)}</textarea>
                        </div>

                        <div class="mt-4" style="background: linear-gradient(to right, #1e3a8a, #1e40af); border: 3px solid #3b82f6; border-radius: 0.75rem; padding: 2rem;">
                            <h3 class="text-yellow mb-3" style="font-size: 1.3rem; font-weight: 700;">Final Preparation Checklist</h3>
                            <ul class="text-white" style="list-style: none; font-size: 1.05rem; line-height: 1.8;">
                                <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                    <span class="text-green" style="font-weight: 700;">âœ“</span>
                                    <span>Review all evidence sources for credibility (CRAAP test scores 4+) and relevance to your arguments</span>
                                </li>
                                <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                    <span class="text-green" style="font-weight: 700;">âœ“</span>
                                    <span>Practice delivery with your team, focusing on clarity, confidence, and staying within time limits</span>
                                </li>
                                <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                    <span class="text-green" style="font-weight: 700;">âœ“</span>
                                    <span>Verify you've steelmanned opposing argumentsâ€”can you state their case as well as they would?</span>
                                </li>
                                <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                    <span class="text-green" style="font-weight: 700;">âœ“</span>
                                    <span>Check that you've qualified claims appropriatelyâ€”avoid absolute language where uncertainty exists</span>
                                </li>
                                <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                    <span class="text-green" style="font-weight: 700;">âœ“</span>
                                    <span>Ensure balanced participation among all team members with clear role assignments</span>
                                </li>
                                <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                    <span class="text-green" style="font-weight: 700;">âœ“</span>
                                    <span>Have citations ready to reference during the debate (organized note cards or digital references)</span>
                                </li>
                                <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                    <span class="text-green" style="font-weight: 700;">âœ“</span>
                                    <span>Run through the debate flow tracker to ensure consistency across all phases</span>
                                </li>
                                <li style="display: flex; align-items: flex-start; gap: 0.75rem;">
                                    <span class="text-green" style="font-weight: 700;">âœ“</span>
                                    <span>Export your data as backup and print key sections for reference during the debate</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                `;
            }

            escapeHtml(text) {
                if (!text) return '';
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            render() {
                const sections = [
                    { key: 'research', icon: icons.BookOpen, title: 'Research Components', renderer: () => this.renderResearchSection() },
                    { key: 'searchStrategy', icon: icons.BookOpen, title: 'Search Strategy & Terminology', renderer: () => this.renderSearchStrategy() },
                    { key: 'arguments', icon: icons.Lightbulb, title: 'Arguments & Steelmanning (Toulmin Model)', renderer: () => this.renderArguments() },
                    { key: 'evidence', icon: icons.FileText, title: 'Evidence & Source Tracker (CRAAP Test)', renderer: () => this.renderEvidence() },
                    { key: 'rubric', icon: icons.Award, title: 'Debate Rubric Reference', renderer: () => this.renderRubric() },
                    { key: 'factCheck', icon: icons.AlertTriangle, title: 'Fact-Checking & Lateral Reading', renderer: () => this.renderFactCheck() },
                    { key: 'fallacies', icon: icons.AlertTriangle, title: 'Logical Fallacy Detector', renderer: () => this.renderFallacies() },
                    { key: 'debateFlow', icon: icons.Award, title: 'Debate Flow Tracker', renderer: () => this.renderDebateFlow() },
                    { key: 'prep', icon: icons.Clock, title: 'Debate Day Preparation', renderer: () => this.renderPrep() }
                ];

                this.shadowRoot.innerHTML = `
                    <style>${css}</style>
                    <a href="#main-content" class="skip-link">Skip to main content</a>
                    <div class="save-indicator" role="status" aria-live="polite">Auto-saved</div>
                    <div class="container">
                        <div class="max-w-6xl">
                            ${this.renderHeader()}
                            <div id="main-content" tabindex="-1">
                                ${this.renderControls()}
                                
                                ${sections.map(section => `
                                    <div class="section-panel">
                                        <button 
                                            class="section-header" 
                                            data-toggle="${section.key}"
                                            aria-expanded="${this.state.expandedSections[section.key]}"
                                            aria-controls="section-${section.key}"
                                        >
                                            <div class="section-title">
                                                <span class="text-yellow" aria-hidden="true">${section.icon}</span>
                                                <h2>${section.title}</h2>
                                            </div>
                                            <span class="text-green" aria-hidden="true">
                                                ${this.state.expandedSections[section.key] ? icons.ChevronUp : icons.ChevronDown}
                                            </span>
                                        </button>
                                        <div id="section-${section.key}" ${this.state.expandedSections[section.key] ? '' : 'hidden'}>
                                            ${section.renderer()}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;

                this.attachEventListeners();
            }

            attachEventListeners() {
                const root = this.shadowRoot;

                root.querySelectorAll('[data-toggle]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.toggleSection(btn.dataset.toggle);
                    });
                });

                root.querySelectorAll('[data-bind]').forEach(input => {
                    input.addEventListener('input', (e) => {
                        const path = e.target.dataset.bind.split('.');
                        const value = e.target.type === 'number' ? parseInt(e.target.value) || '' : e.target.value;
                        
                        if (path.length === 1) {
                            this.state[path[0]] = value;
                        } else if (path.length === 2) {
                            this.state[path[0]][path[1]] = value;
                        } else if (path.length === 3) {
                            const [obj, index, key] = path;
                            const idx = parseInt(index);
                            if (this.state[obj][idx]) {
                                this.state[obj][idx][key] = value;
                            }
                        }
                        
                        this.debouncedSave();
                    });

                    if (input.dataset.bind === 'position' || input.dataset.bind === 'selectedPlant') {
                        input.addEventListener('change', () => {
                            this.saveState();
                            this.render();
                        });
                    }
                });

                root.addEventListener('click', (e) => {
                    const btn = e.target.closest('button[data-action]');
                    if (!btn) return;

                    const action = btn.dataset.action;
                    const index = parseInt(btn.dataset.index);

                    switch(action) {
                        case 'print':
                            window.print();
                            break;
                        case 'export':
                            this.exportData();
                            break;
                        case 'import':
                            this.importData();
                            break;
                        case 'add-arg':
                            this.state.arguments.push({ 
                                claim: '', 
                                data: '', 
                                warrant: '', 
                                qualifier: '', 
                                rebuttal: '', 
                                source: '' 
                            });
                            this.saveState();
                            this.render();
                            break;
                        case 'delete-arg':
                            this.state.arguments.splice(index, 1);
                            this.state.flow.splice(index, 1);
                            this.saveState();
                            this.render();
                            break;
                        case 'add-counter':
                            this.state.counterArgs.push({ 
                                opposing: '', 
                                understanding: '',
                                rebuttal: '' 
                            });
                            this.saveState();
                            this.render();
                            break;
                        case 'delete-counter':
                            this.state.counterArgs.splice(index, 1);
                            this.saveState();
                            this.render();
                            break;
                        case 'add-evidence':
                            this.state.evidence.push({ 
                                claim: '', 
                                source: '', 
                                citation: '', 
                                citationType: 'mla',
                                currency: '', 
                                relevance: '', 
                                authority: '', 
                                accuracy: '', 
                                purpose: '', 
                                reliability: '' 
                            });
                            this.saveState();
                            this.render();
                            break;
                        case 'delete-evidence':
                            this.state.evidence.splice(index, 1);
                            this.saveState();
                            this.render();
                            break;
                        case 'add-question':
                            this.state.questions.push({ question: '', purpose: '' });
                            this.saveState();
                            this.render();
                            break;
                        case 'delete-question':
                            this.state.questions.splice(index, 1);
                            this.saveState();
                            this.render();
                            break;
                        case 'start':
                            this.state.timerActive = true;
                            this.updateControlButtons();
                            break;
                        case 'pause':
                            this.state.timerActive = false;
                            this.updateControlButtons();
                            break;
                        case 'reset':
                            this.state.timerActive = false;
                            const modes = {
                                opening: 120,
                                arguments: 240,
                                rebuttal: 120,
                                crossExam: 180,
                                closing: 120
                            };
                            this.state.timerSeconds = modes[this.state.timerMode] || 120;
                            this.updateTimerDisplay();
                            this.updateControlButtons();
                            break;
                    }
                });

                this.attachTimerControls();
            }

            attachTimerControls() {
                const root = this.shadowRoot;
                root.querySelectorAll('[data-timer]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.state.timerMode = btn.dataset.timer;
                        this.state.timerSeconds = parseInt(btn.dataset.seconds);
                        this.state.timerActive = false;
                        this.updateTimerDisplay();
                        this.updateControlButtons();
                    });
                });
            }
        }

        customElements.define('nuclear-debate-prep', NuclearDebatePrep);
    })();
    </script>
</body>
</html>
